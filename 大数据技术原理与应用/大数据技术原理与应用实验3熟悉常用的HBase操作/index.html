<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>大数据技术原理与应用实验3熟悉常用的HBase操作 | hsuwindowBlogs</title><meta name="author" content="hsuwindow"><meta name="copyright" content="hsuwindow"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="实验3 熟悉常用的HBase操作1.  实验目的（1） 理解 HBase 在 Hadoop 体系结构中的角色； （2） 熟练使用 HBase 操作常用的 Shell 命令； （3） 熟悉 HBase 操作常用的 Java API。 2.实验平台（1） 操作系统： Linux（Ubuntu-22.04.2-desktop-amd64）； （2） Hadoop 版本： 3.1.3； （3） HBase">
<meta property="og:type" content="article">
<meta property="og:title" content="大数据技术原理与应用实验3熟悉常用的HBase操作">
<meta property="og:url" content="http://hsuwindow.vip/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%E5%AE%9E%E9%AA%8C3%E7%86%9F%E6%82%89%E5%B8%B8%E7%94%A8%E7%9A%84HBase%E6%93%8D%E4%BD%9C/index.html">
<meta property="og:site_name" content="hsuwindowBlogs">
<meta property="og:description" content="实验3 熟悉常用的HBase操作1.  实验目的（1） 理解 HBase 在 Hadoop 体系结构中的角色； （2） 熟练使用 HBase 操作常用的 Shell 命令； （3） 熟悉 HBase 操作常用的 Java API。 2.实验平台（1） 操作系统： Linux（Ubuntu-22.04.2-desktop-amd64）； （2） Hadoop 版本： 3.1.3； （3） HBase">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://hsuwindow.vip/img/ubuntu_icon.png">
<meta property="article:published_time" content="2023-04-05T06:11:18.000Z">
<meta property="article:modified_time" content="2023-04-05T07:38:04.029Z">
<meta property="article:author" content="hsuwindow">
<meta property="article:tag" content="大数据">
<meta property="article:tag" content="学习">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://hsuwindow.vip/img/ubuntu_icon.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://hsuwindow.vip/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%E5%AE%9E%E9%AA%8C3%E7%86%9F%E6%82%89%E5%B8%B8%E7%94%A8%E7%9A%84HBase%E6%93%8D%E4%BD%9C/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        if (name && globalFn[key][name]) return
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '大数据技术原理与应用实验3熟悉常用的HBase操作',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-04-05 15:38:04'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/ubuntu_icon.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">78</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">25</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">20</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">hsuwindowBlogs</span></a><a class="nav-page-title" href="/"><span class="site-name">大数据技术原理与应用实验3熟悉常用的HBase操作</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">大数据技术原理与应用实验3熟悉常用的HBase操作</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-04-05T06:11:18.000Z" title="发表于 2023-04-05 14:11:18">2023-04-05</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-04-05T07:38:04.029Z" title="更新于 2023-04-05 15:38:04">2023-04-05</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8/">大数据技术原理与应用</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="实验3-熟悉常用的HBase操作"><a href="#实验3-熟悉常用的HBase操作" class="headerlink" title="实验3 熟悉常用的HBase操作"></a>实验3 熟悉常用的HBase操作</h1><h1 id="1-实验目的"><a href="#1-实验目的" class="headerlink" title="1.  实验目的"></a>1.  实验目的</h1><p>（1） 理解 HBase 在 Hadoop 体系结构中的角色；<br> （2） 熟练使用 HBase 操作常用的 Shell 命令；<br> （3） 熟悉 HBase 操作常用的 Java API。</p>
<h1 id="2-实验平台"><a href="#2-实验平台" class="headerlink" title="2.实验平台"></a>2.实验平台</h1><p>（1） 操作系统： Linux（Ubuntu-22.04.2-desktop-amd64）；</p>
<p>（2） Hadoop 版本： 3.1.3；</p>
<p>（3） HBase版本：</p>
<p>（4） JDK 版本： 1.8；</p>
<p>（5） Java IDE： Eclipse。 </p>
<h1 id="3-实验步骤与结果"><a href="#3-实验步骤与结果" class="headerlink" title="3.实验步骤与结果"></a>3.实验步骤与结果</h1><p>（一）编程实现以下指定功能，并用 Hadoop 提供的 HBase Shell 命令完成相同任务：<br>     （1） 列出 HBase 所有的表的相关信息，例如表名；</p>
<p>运行结果+Java代码：</p>
<p><img src="https://bradtorresblog.oss-cn-beijing.aliyuncs.com/BigDataExperiment3/clip_image001.png" alt="img"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.conf.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.*;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.client.*;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">test1</span> &#123;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Configuration configuration;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Connection connection;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Admin admin;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> args</span></span><br><span class="line"><span class="comment">* 建立连接</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">()</span>&#123;</span><br><span class="line">configuration = HBaseConfiguration.create();</span><br><span class="line">configuration.set(<span class="string">&quot;hbase.rootdir&quot;</span>, <span class="string">&quot;hdfs://localhost:9000/hbase&quot;</span>);</span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">connection = ConnectionFactory.createConnection(configuration);</span><br><span class="line">admin = connection.getAdmin();</span><br><span class="line">&#125;<span class="keyword">catch</span>(IOException e)&#123;</span><br><span class="line">e.printStackTrace();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//关闭连接</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">close</span><span class="params">()</span>&#123;</span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line"><span class="keyword">if</span>(admin != <span class="literal">null</span>)&#123;</span><br><span class="line">admin.close();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="literal">null</span> != connection)&#123;</span><br><span class="line">connection.close();</span><br><span class="line">&#125;</span><br><span class="line">&#125;<span class="keyword">catch</span>(IOException e)&#123;</span><br><span class="line">e.printStackTrace();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* 查看已有表</span></span><br><span class="line"><span class="comment">* @throws IOException</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">listTables</span><span class="params">()</span> <span class="keyword">throws</span> IOException&#123;</span><br><span class="line">init();</span><br><span class="line"><span class="meta">@SuppressWarnings(&quot;deprecation&quot;)</span></span><br><span class="line">HTableDescriptor hTableDescriptors [] = admin.listTables();</span><br><span class="line"><span class="keyword">for</span>(HTableDescriptor hTableDescriptor : hTableDescriptors)&#123;</span><br><span class="line">System.out.println(hTableDescriptor.getNameAsString());</span><br><span class="line">&#125;</span><br><span class="line">close();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"><span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line"><span class="type">test1</span> <span class="variable">t</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">test1</span>();</span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">System.out.println(<span class="string">&quot;以下为Hbase数据库中所存的表信息&quot;</span>);</span><br><span class="line">t.listTables();</span><br><span class="line">&#125;<span class="keyword">catch</span> (IOException e)&#123;</span><br><span class="line">e.printStackTrace();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>HBase Shell 命令：</p>
<p><img src="https://bradtorresblog.oss-cn-beijing.aliyuncs.com/BigDataExperiment3/clip_image002.png" alt="img"></p>
<p>​     （2） 在终端打印出指定的表的所有记录数据；</p>
<p>运行结果+Java代码:</p>
<p><img src="https://bradtorresblog.oss-cn-beijing.aliyuncs.com/BigDataExperiment3/clip_image004.png" alt="img"></p>
<p><img src="https://bradtorresblog.oss-cn-beijing.aliyuncs.com/BigDataExperiment3/clip_image006.png" alt="img"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.conf.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.client.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test_2</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Configuration configuration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Connection connection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Admin admin;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> args</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//建立连接</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">configuration = HBaseConfiguration.create();</span><br><span class="line"></span><br><span class="line">configuration.set(<span class="string">&quot;hbase.rootdir&quot;</span>,<span class="string">&quot;hdfs://localhost:9000/hbase&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line"></span><br><span class="line">connection = ConnectionFactory.createConnection(configuration);</span><br><span class="line"></span><br><span class="line">admin = connection.getAdmin();</span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">catch</span> (IOException e)&#123;</span><br><span class="line"></span><br><span class="line">e.printStackTrace();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//关闭连接</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">close</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(admin != <span class="literal">null</span>)&#123;</span><br><span class="line"></span><br><span class="line">admin.close();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="literal">null</span> != connection)&#123;</span><br><span class="line"></span><br><span class="line">connection.close();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">catch</span> (IOException e)&#123;</span><br><span class="line"></span><br><span class="line">e.printStackTrace();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">* 根据表名查找表信息</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">getData</span><span class="params">(String tableName)</span><span class="keyword">throws</span> IOException&#123;</span><br><span class="line"></span><br><span class="line">init();</span><br><span class="line"></span><br><span class="line"><span class="type">Table</span> <span class="variable">table</span> <span class="operator">=</span> connection.getTable(TableName.valueOf(tableName));</span><br><span class="line"></span><br><span class="line"><span class="type">Scan</span> <span class="variable">scan</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scan</span>();</span><br><span class="line"></span><br><span class="line"><span class="type">ResultScanner</span> <span class="variable">scanner</span> <span class="operator">=</span> table.getScanner(scan);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(Result result:scanner)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">showCell((result));</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">close();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">* 格式化输出</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> result</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">showCell</span><span class="params">(Result result)</span>&#123;</span><br><span class="line"></span><br><span class="line">Cell[] cells = result.rawCells();</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(Cell cell:cells)&#123;</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;RowName(行键):&quot;</span>+<span class="keyword">new</span></span><br><span class="line"><span class="title class_">String</span>(CellUtil.cloneRow(cell))+<span class="string">&quot; &quot;</span>);</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;Timetamp(时间戳):&quot;</span>+cell.getTimestamp()+<span class="string">&quot; &quot;</span>);</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;column Family（列簇）:&quot;</span>+<span class="keyword">new</span></span><br><span class="line"><span class="title class_">String</span>(CellUtil.cloneFamily(cell))+<span class="string">&quot; &quot;</span>);</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;column Name（列名）:&quot;</span>+<span class="keyword">new</span></span><br><span class="line"><span class="title class_">String</span>(CellUtil.cloneQualifier(cell))+<span class="string">&quot; &quot;</span>);</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;value:（值）&quot;</span>+<span class="keyword">new</span></span><br><span class="line"><span class="title class_">String</span>(CellUtil.cloneValue(cell))+<span class="string">&quot; &quot;</span>);</span><br><span class="line"></span><br><span class="line">System.out.println();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line"></span><br><span class="line"><span class="type">Test_2</span> <span class="variable">t</span> <span class="operator">=</span><span class="keyword">new</span> <span class="title class_">Test_2</span>();</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;请输入要查看的表名&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="type">Scanner</span> <span class="variable">scan</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line"></span><br><span class="line">String tableName=scan.nextLine();</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;信息如下：&quot;</span>);</span><br><span class="line"></span><br><span class="line">t.getData(tableName);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>HBase Shell 命令：</p>
<p><img src="https://bradtorresblog.oss-cn-beijing.aliyuncs.com/BigDataExperiment3/clip_image008.png" alt="img"></p>
<pre><code> （3） 向已经创建好的表添加和删除指定的列族或列；
</code></pre>
<p>运行结果+Java代码：</p>
<p>添加：</p>
<p><img src="https://bradtorresblog.oss-cn-beijing.aliyuncs.com/BigDataExperiment3/clip_image010.png" alt="img"></p>
<p><img src="https://bradtorresblog.oss-cn-beijing.aliyuncs.com/BigDataExperiment3/clip_image012.png" alt="img"></p>
<p>删除：</p>
<p><img src="https://bradtorresblog.oss-cn-beijing.aliyuncs.com/BigDataExperiment3/clip_image014.png" alt="img"></p>
<p><img src="https://bradtorresblog.oss-cn-beijing.aliyuncs.com/BigDataExperiment3/clip_image016.png" alt="img"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.conf.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.Cell;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.CellUtil;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.HBaseConfiguration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.TableName;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.client.Admin;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.client.Connection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.client.ConnectionFactory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.client.Delete;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.client.Put;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.client.Result;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.client.ResultScanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.client.Scan;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.client.Table;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test_3</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Configuration configuration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Connection connection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Admin admin;</span><br><span class="line"></span><br><span class="line"><span class="comment">//建立连接</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">configuration = HBaseConfiguration.create();</span><br><span class="line"></span><br><span class="line">configuration.set(<span class="string">&quot;hbase.rootdir&quot;</span>,<span class="string">&quot;hdfs://localhost:9000/hbase&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line"></span><br><span class="line">connection = ConnectionFactory.createConnection(configuration);</span><br><span class="line"></span><br><span class="line">admin = connection.getAdmin();</span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">catch</span> (IOException e)&#123;</span><br><span class="line"></span><br><span class="line">e.printStackTrace();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//关闭连接</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">close</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(admin != <span class="literal">null</span>)&#123;</span><br><span class="line"></span><br><span class="line">admin.close();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="literal">null</span> != connection)&#123;</span><br><span class="line"></span><br><span class="line">connection.close();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">catch</span> (IOException e)&#123;</span><br><span class="line"></span><br><span class="line">e.printStackTrace();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">* 向某一行的某一列插入数据</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> tableName 表名</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> rowKey 行键</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> colFamily 列族名</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> col 列名（如果其列族下没有子列，此参数可为空）</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> val 值</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">* <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">insertRow</span><span class="params">(String tableName,String rowKey,String</span></span><br><span class="line"><span class="params">colFamily,String col,String val)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line"></span><br><span class="line">init();</span><br><span class="line"></span><br><span class="line"><span class="type">Table</span> <span class="variable">table</span> <span class="operator">=</span> connection.getTable(TableName.valueOf(tableName));</span><br><span class="line"></span><br><span class="line"><span class="type">Put</span> <span class="variable">put</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Put</span>(rowKey.getBytes());</span><br><span class="line"></span><br><span class="line">put.addColumn(colFamily.getBytes(), col.getBytes(), val.getBytes());</span><br><span class="line"></span><br><span class="line">table.put(put);</span><br><span class="line"></span><br><span class="line">table.close();</span><br><span class="line"></span><br><span class="line">close();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">* 根据表名查找表信息</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">getData</span><span class="params">(String tableName)</span><span class="keyword">throws</span> IOException&#123;</span><br><span class="line"></span><br><span class="line">init();</span><br><span class="line"></span><br><span class="line"><span class="type">Table</span> <span class="variable">table</span> <span class="operator">=</span> connection.getTable(TableName.valueOf(tableName));</span><br><span class="line"></span><br><span class="line"><span class="type">Scan</span> <span class="variable">scan</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scan</span>();</span><br><span class="line"></span><br><span class="line"><span class="type">ResultScanner</span> <span class="variable">scanner</span> <span class="operator">=</span> table.getScanner(scan);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(Result result:scanner)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">showCell((result));</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">close();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">* 格式化输出</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> result</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">showCell</span><span class="params">(Result result)</span>&#123;</span><br><span class="line"></span><br><span class="line">Cell[] cells = result.rawCells();</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(Cell cell:cells)&#123;</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;RowName(行键):&quot;</span>+<span class="keyword">new</span></span><br><span class="line"><span class="title class_">String</span>(CellUtil.cloneRow(cell))+<span class="string">&quot; &quot;</span>);</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;Timetamp(时间戳):&quot;</span>+cell.getTimestamp()+<span class="string">&quot; &quot;</span>);</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;column Family（列簇）:&quot;</span>+<span class="keyword">new</span></span><br><span class="line"><span class="title class_">String</span>(CellUtil.cloneFamily(cell))+<span class="string">&quot; &quot;</span>);</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;column Name（列名）:&quot;</span>+<span class="keyword">new</span></span><br><span class="line"><span class="title class_">String</span>(CellUtil.cloneQualifier(cell))+<span class="string">&quot; &quot;</span>);</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;value:（值）&quot;</span>+<span class="keyword">new</span></span><br><span class="line"><span class="title class_">String</span>(CellUtil.cloneValue(cell))+<span class="string">&quot; &quot;</span>);</span><br><span class="line"></span><br><span class="line">System.out.println();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">* 删除数据</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> tableName 表名</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> rowKey 行键</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> colFamily 列族名</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> col 列名</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">* <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">deleteRow</span><span class="params">(String tableName,String rowKey,String</span></span><br><span class="line"><span class="params">colFamily,String col)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line"></span><br><span class="line">init();</span><br><span class="line"></span><br><span class="line"><span class="type">Table</span> <span class="variable">table</span> <span class="operator">=</span> connection.getTable(TableName.valueOf(tableName));</span><br><span class="line"></span><br><span class="line"><span class="type">Delete</span> <span class="variable">delete</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Delete</span>(rowKey.getBytes());</span><br><span class="line"></span><br><span class="line"><span class="type">boolean</span> <span class="variable">flag2</span> <span class="operator">=</span><span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(flag2)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;请输入你的选择 1-删除列族的所有数据2-指定列的数据&quot;</span>);</span><br><span class="line"></span><br><span class="line">Scanner scanner=<span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line"></span><br><span class="line"><span class="type">String</span> <span class="variable">chooseString</span> <span class="operator">=</span> scanner.nextLine();</span><br><span class="line"></span><br><span class="line"><span class="keyword">switch</span> (chooseString) &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">case</span> <span class="string">&quot;1&quot;</span>:</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">//删除指定列族的所有数据</span></span><br><span class="line"></span><br><span class="line">delete.addFamily(colFamily.getBytes());</span><br><span class="line"></span><br><span class="line">table.delete(delete);</span><br><span class="line"></span><br><span class="line">table.close();</span><br><span class="line"></span><br><span class="line">close();</span><br><span class="line"></span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">case</span> <span class="string">&quot;2&quot;</span>:</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">//删除指定列的数据</span></span><br><span class="line"></span><br><span class="line">delete.addColumn(colFamily.getBytes(), col.getBytes());</span><br><span class="line"></span><br><span class="line">table.delete(delete);</span><br><span class="line"></span><br><span class="line">table.close();</span><br><span class="line"></span><br><span class="line">close();</span><br><span class="line"></span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot; 你的输入有误 ！！！ &quot;</span>);</span><br><span class="line"></span><br><span class="line">table.close();</span><br><span class="line"></span><br><span class="line">close();</span><br><span class="line"></span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot; 你要继续操作吗？ 是-true 否-false &quot;</span>);</span><br><span class="line"></span><br><span class="line">flag2=scanner.nextBoolean();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> args</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line"></span><br><span class="line"><span class="type">Test_3</span> <span class="variable">t</span> <span class="operator">=</span><span class="keyword">new</span> <span class="title class_">Test_3</span>();</span><br><span class="line"></span><br><span class="line"><span class="type">boolean</span> <span class="variable">flag</span> <span class="operator">=</span><span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(flag)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;------------向已经创建好的表中添加和删除指定的列簇或列--------------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot; 请输入您要进行的操作 1- 添加 2-删除 &quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="type">Scanner</span> <span class="variable">scan</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line"></span><br><span class="line">String choose1=scan.nextLine();</span><br><span class="line"></span><br><span class="line"><span class="keyword">switch</span> (choose1) &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">case</span> <span class="string">&quot;1&quot;</span>:</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;请输入要添加的表名&quot;</span>);</span><br><span class="line"></span><br><span class="line">String tableName=scan.nextLine();</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;请输入要添加的表的行键&quot;</span>);</span><br><span class="line"></span><br><span class="line">String rowKey=scan.nextLine();</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;请输入要添加的表的列簇&quot;</span>);</span><br><span class="line"></span><br><span class="line">String colFamily=scan.nextLine();</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;请输入要添加的表的列名&quot;</span>);</span><br><span class="line"></span><br><span class="line">String col=scan.nextLine();</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;请输入要添加的值&quot;</span>);</span><br><span class="line"></span><br><span class="line">String val=scan.nextLine();</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line"></span><br><span class="line">t.insertRow(tableName, rowKey, colFamily, col, val);</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;插入成功：&quot;</span>);</span><br><span class="line"></span><br><span class="line">t.getData(tableName);</span><br><span class="line"></span><br><span class="line">&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line"></span><br><span class="line">e.getMessage();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">case</span> <span class="string">&quot;2&quot;</span>:</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;请输入要删除的表名&quot;</span>);</span><br><span class="line"></span><br><span class="line">String tableName=scan.nextLine();</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;请输入要删除的表的行键&quot;</span>);</span><br><span class="line"></span><br><span class="line">String rowKey=scan.nextLine();</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;请输入要删除的表的列簇&quot;</span>);</span><br><span class="line"></span><br><span class="line">String colFamily=scan.nextLine();</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;请输入要删除的表的列名&quot;</span>);</span><br><span class="line"></span><br><span class="line">String col=scan.nextLine();</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;----------------------表的原本信息如下---------------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">t.getData(tableName);</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;____________________________正在执行删除操作…\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">t.deleteRow(tableName, rowKey, colFamily, col);</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;____________________________删除成功_______________\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;---------------------删除后表的信息如下---------------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">t.getData(tableName);</span><br><span class="line"></span><br><span class="line">&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line"></span><br><span class="line">e.getMessage();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot; 你的操作有误 ！！！ &quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot; 你要继续操作吗？ 是-true 否-false &quot;</span>);</span><br><span class="line"></span><br><span class="line">flag=scan.nextBoolean();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot; 程序已退出！ &quot;</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>HBase Shell 命令：</p>
<p>添加：</p>
<p><img src="https://bradtorresblog.oss-cn-beijing.aliyuncs.com/BigDataExperiment3/clip_image018.png" alt="img"></p>
<p>删除：</p>
<p><img src="https://bradtorresblog.oss-cn-beijing.aliyuncs.com/BigDataExperiment3/clip_image019.png" alt="img"><br>     （4） 清空指定的表的所有记录数据；</p>
<p>运行结果+Java代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.conf.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.Cell;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.CellUtil;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.HBaseConfiguration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.HColumnDescriptor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.HTableDescriptor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.TableName;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.client.Admin;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.client.Connection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.client.ConnectionFactory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.client.HBaseAdmin;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.client.Result;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.client.ResultScanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.client.Scan;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.client.Table;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.util.Bytes;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test_4</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Configuration configuration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Connection connection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Admin admin;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> args</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//建立连接</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">configuration = HBaseConfiguration.create();</span><br><span class="line"></span><br><span class="line">configuration.set(<span class="string">&quot;hbase.rootdir&quot;</span>,<span class="string">&quot;hdfs://localhost:9000/hbase&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line"></span><br><span class="line">connection = ConnectionFactory.createConnection(configuration);</span><br><span class="line"></span><br><span class="line">admin = connection.getAdmin();</span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">catch</span> (IOException e)&#123;</span><br><span class="line"></span><br><span class="line">e.printStackTrace();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//关闭连接</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">close</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(admin != <span class="literal">null</span>)&#123;</span><br><span class="line"></span><br><span class="line">admin.close();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="literal">null</span> != connection)&#123;</span><br><span class="line"></span><br><span class="line">connection.close();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">catch</span> (IOException e)&#123;</span><br><span class="line"></span><br><span class="line">e.printStackTrace();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">* 清空制定的表的所有记录数据</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> args</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">* <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">clearRows</span><span class="params">(String tableName)</span> <span class="keyword">throws</span> IOException&#123;</span><br><span class="line"></span><br><span class="line">init();</span><br><span class="line"></span><br><span class="line"><span class="comment">// HBaseAdmin admin1=new HBaseAdmin(configuration);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// HTableDescriptor tDescriptor=admin1.getTableDescriptor(Bytes.toBytes(tableName));</span></span><br><span class="line"><span class="comment">//读取了之前表的表名列簇等信息，然后再进行删除操作。总思想是先将原表结构保留下来，然后进行删除，再重新依据保存的信息重新创建表。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//备份表列族名</span></span><br><span class="line"></span><br><span class="line">TableName tablename=TableName.valueOf(tableName);</span><br><span class="line"></span><br><span class="line"><span class="type">HTableDescriptor</span> <span class="variable">tDescriptor</span> <span class="operator">=</span> <span class="keyword">new</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">HTableDescriptor</span>(TableName.valueOf(tableName));</span><br><span class="line"></span><br><span class="line"><span class="type">Table</span> <span class="variable">table</span> <span class="operator">=</span> connection.getTable(TableName.valueOf(tableName));</span><br><span class="line"></span><br><span class="line"><span class="type">Scan</span> <span class="variable">scan</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scan</span>();</span><br><span class="line"></span><br><span class="line"><span class="type">ResultScanner</span> <span class="variable">scanner</span> <span class="operator">=</span> table.getScanner(scan);</span><br><span class="line"></span><br><span class="line">List&lt;String&gt; cloFamily = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;String&gt;();</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(Result result:scanner)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">Cell[] cells = result.rawCells();</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(Cell cell:cells)&#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">// System.out.println(&quot;column Family（列簇）:&quot;+newString(CellUtil.cloneFamily(cell))+&quot; &quot;);</span></span><br><span class="line"></span><br><span class="line">cloFamily.add(<span class="keyword">new</span> <span class="title class_">String</span>(CellUtil.cloneFamily(cell)));</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//删除表</span></span><br><span class="line"></span><br><span class="line">admin.disableTable(tablename);</span><br><span class="line"></span><br><span class="line">admin.deleteTable(tablename);</span><br><span class="line"></span><br><span class="line"><span class="comment">//重新建表</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// HTableDescriptor tDescriptor = new</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// HTableDescriptor(TableName.valueOf(tableName));</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// tDescriptor.addFamily(new HColumnDescriptor(&quot;name&quot;));</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(String cf : cloFamily)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">tDescriptor.addFamily(<span class="keyword">new</span> <span class="title class_">HColumnDescriptor</span>(cf));</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">admin.createTable(tDescriptor);</span><br><span class="line"></span><br><span class="line">close();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">* 根据表名查找表信息</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">getData</span><span class="params">(String tableName)</span><span class="keyword">throws</span> IOException&#123;</span><br><span class="line"></span><br><span class="line">init();</span><br><span class="line"></span><br><span class="line"><span class="type">Table</span> <span class="variable">table</span> <span class="operator">=</span> connection.getTable(TableName.valueOf(tableName));</span><br><span class="line"></span><br><span class="line"><span class="type">Scan</span> <span class="variable">scan</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scan</span>();</span><br><span class="line"></span><br><span class="line"><span class="type">ResultScanner</span> <span class="variable">scanner</span> <span class="operator">=</span> table.getScanner(scan);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(Result result:scanner)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">showCell((result));</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">close();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">* 格式化输出</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> result</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">showCell</span><span class="params">(Result result)</span>&#123;</span><br><span class="line"></span><br><span class="line">Cell[] cells = result.rawCells();</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(Cell cell:cells)&#123;</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;RowName(行键):&quot;</span>+<span class="keyword">new</span></span><br><span class="line"><span class="title class_">String</span>(CellUtil.cloneRow(cell))+<span class="string">&quot; &quot;</span>);</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;Timetamp(时间戳):&quot;</span>+cell.getTimestamp()+<span class="string">&quot; &quot;</span>);</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;column Family（列簇）:&quot;</span>+<span class="keyword">new</span></span><br><span class="line"><span class="title class_">String</span>(CellUtil.cloneFamily(cell))+<span class="string">&quot; &quot;</span>);</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;column Name（列名）:&quot;</span>+<span class="keyword">new</span></span><br><span class="line"><span class="title class_">String</span>(CellUtil.cloneQualifier(cell))+<span class="string">&quot; &quot;</span>);</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;value:（值）&quot;</span>+<span class="keyword">new</span></span><br><span class="line"><span class="title class_">String</span>(CellUtil.cloneValue(cell))+<span class="string">&quot; &quot;</span>);</span><br><span class="line"></span><br><span class="line">System.out.println();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line"></span><br><span class="line">Test_4 test_4=<span class="keyword">new</span> <span class="title class_">Test_4</span>();</span><br><span class="line"></span><br><span class="line"><span class="type">Scanner</span> <span class="variable">scan</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;请输入要清空的表名&quot;</span>);</span><br><span class="line"></span><br><span class="line">String tableName=scan.nextLine();</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;表原来的信息：&quot;</span>);</span><br><span class="line"></span><br><span class="line">test_4.getData(tableName);</span><br><span class="line"></span><br><span class="line">test_4.clearRows(tableName);</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;表已清空：&quot;</span>);</span><br><span class="line"></span><br><span class="line">&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line"></span><br><span class="line">e.printStackTrace();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>HBase Shell 命令：</p>
<p><img src="https://bradtorresblog.oss-cn-beijing.aliyuncs.com/BigDataExperiment3/clip_image021.png" alt="img">    （5） 统计表的行数。</p>
<p>运行结果+Java代码：</p>
<p><img src="https://bradtorresblog.oss-cn-beijing.aliyuncs.com/BigDataExperiment3/clip_image022.png" alt="img"></p>
<p><img src="https://bradtorresblog.oss-cn-beijing.aliyuncs.com/BigDataExperiment3/clip_image023.png" alt="img"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.conf.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.HBaseConfiguration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.TableName;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.client.Admin;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.client.Connection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.client.ConnectionFactory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.client.Result;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.client.ResultScanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.client.Scan;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.client.Table;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test_5</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Configuration configuration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Connection connection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Admin admin;</span><br><span class="line"></span><br><span class="line"><span class="comment">//建立连接</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">configuration = HBaseConfiguration.create();</span><br><span class="line"></span><br><span class="line">configuration.set(<span class="string">&quot;hbase.rootdir&quot;</span>,<span class="string">&quot;hdfs://localhost:9000/hbase&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line"></span><br><span class="line">connection = ConnectionFactory.createConnection(configuration);</span><br><span class="line"></span><br><span class="line">admin = connection.getAdmin();</span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">catch</span> (IOException e)&#123;</span><br><span class="line"></span><br><span class="line">e.printStackTrace();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//关闭连接</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">close</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(admin != <span class="literal">null</span>)&#123;</span><br><span class="line"></span><br><span class="line">admin.close();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="literal">null</span> != connection)&#123;</span><br><span class="line"></span><br><span class="line">connection.close();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">catch</span> (IOException e)&#123;</span><br><span class="line"></span><br><span class="line">e.printStackTrace();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">countRows</span> <span class="params">(String tableName)</span> <span class="keyword">throws</span> IOException</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">init();</span><br><span class="line"></span><br><span class="line"><span class="type">Table</span> <span class="variable">table</span> <span class="operator">=</span> connection.getTable(TableName.valueOf(tableName));</span><br><span class="line"></span><br><span class="line"><span class="type">Scan</span> <span class="variable">scan</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scan</span>();</span><br><span class="line"></span><br><span class="line"><span class="type">ResultScanner</span> <span class="variable">scanner</span> <span class="operator">=</span>table.getScanner(scan);</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="variable">num</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="type">Result</span> <span class="variable">result</span> <span class="operator">=</span> scanner.next();result!=<span class="literal">null</span>;result=scanner.next())</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">num++;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;行数：&quot;</span>+num);</span><br><span class="line"></span><br><span class="line">scanner.close();</span><br><span class="line"></span><br><span class="line">close();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> args</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">* <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line"></span><br><span class="line">Test_5 test_5=<span class="keyword">new</span> <span class="title class_">Test_5</span>();</span><br><span class="line"></span><br><span class="line"><span class="type">Scanner</span> <span class="variable">scan</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;请输入要统计行数的表名&quot;</span>);</span><br><span class="line"></span><br><span class="line">String tableName=scan.nextLine();</span><br><span class="line"></span><br><span class="line">test_5.countRows(tableName);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>HBase Shell 命令：</p>
<p><img src="https://bradtorresblog.oss-cn-beijing.aliyuncs.com/BigDataExperiment3/clip_image025.png" alt="img"></p>
<p>（二） HBase 数据库操作</p>
<p>\1. 现有以下关系型数据库中的表和数据（见表14-3到表14-5），要求将其转换为适合于HBase 存储的表并插入数据：</p>
<p>表14-3学生表（Student）</p>
<table>
<thead>
<tr>
<th>学号（S_No）</th>
<th>姓名（S_Name）</th>
<th>性别（S_Sex）</th>
<th>年龄（S_Age）</th>
</tr>
</thead>
<tbody><tr>
<td>2015001</td>
<td>Zhangsan</td>
<td>male</td>
<td>23</td>
</tr>
<tr>
<td>2015002</td>
<td>Mary</td>
<td>female</td>
<td>22</td>
</tr>
<tr>
<td>2015003</td>
<td>Lisi</td>
<td>male</td>
<td>24</td>
</tr>
</tbody></table>
<p>表14-4课程表（Course）</p>
<table>
<thead>
<tr>
<th>课程号（C_No）</th>
<th>课程名（C_Name）</th>
<th>学分（C_Credit）</th>
</tr>
</thead>
<tbody><tr>
<td>123001</td>
<td>Math</td>
<td>2.0</td>
</tr>
<tr>
<td>123002</td>
<td>Computer Science</td>
<td>5.0</td>
</tr>
<tr>
<td>123003</td>
<td>English</td>
<td>3.0</td>
</tr>
</tbody></table>
<p>表14-5选课表（SC）</p>
<table>
<thead>
<tr>
<th>学号（SC_Sno）</th>
<th>课程号（SC_Cno）</th>
<th>成绩（SC_Score）</th>
</tr>
</thead>
<tbody><tr>
<td>2015001</td>
<td>123001</td>
<td>86</td>
</tr>
<tr>
<td>2015001</td>
<td>123003</td>
<td>69</td>
</tr>
<tr>
<td>2015002</td>
<td>123002</td>
<td>77</td>
</tr>
<tr>
<td>2015002</td>
<td>123003</td>
<td>99</td>
</tr>
<tr>
<td>2015003</td>
<td>123001</td>
<td>98</td>
</tr>
<tr>
<td>2015003</td>
<td>123002</td>
<td>95</td>
</tr>
</tbody></table>
<p>学生表：</p>
<p><img src="https://bradtorresblog.oss-cn-beijing.aliyuncs.com/BigDataExperiment3/clip_image027.png" alt="img"></p>
<p><img src="https://bradtorresblog.oss-cn-beijing.aliyuncs.com/BigDataExperiment3/clip_image029.png" alt="img"></p>
<p>课程表</p>
<p><img src="https://bradtorresblog.oss-cn-beijing.aliyuncs.com/BigDataExperiment3/clip_image031.png" alt="img"></p>
<p><img src="https://bradtorresblog.oss-cn-beijing.aliyuncs.com/BigDataExperiment3/clip_image033.png" alt="img"></p>
<p>选课表：</p>
<p><img src="https://bradtorresblog.oss-cn-beijing.aliyuncs.com/BigDataExperiment3/clip_image034.png" alt="img"></p>
<p><img src="https://bradtorresblog.oss-cn-beijing.aliyuncs.com/BigDataExperiment3/clip_image035.png" alt="img"></p>
<p><img src="https://bradtorresblog.oss-cn-beijing.aliyuncs.com/BigDataExperiment3/clip_image037.png" alt="img"></p>
<p>\2. 请编程实现以下功能：</p>
<p>​    （1）createTable(String tableName, String[] fields)</p>
<p>​    创建表，参数tableName为表的名称，字符串数组fields为存储记录各个字段名称的数组。要求当 HBase 已经存在名为 tableName 的表的时候，先删除原有的表，然后再创建新的表。</p>
<p>​    （2）addRecord(String tableName, String row, String[] fields, String[] values)<br>​     向表tableName、行row（用S_Name表示）和字符串数组fields指定的单元格中添加对应的数据values。其中，fields中每个元素如果对应的列族下还有相应的列限定符的话，用“columnFamily:column”表示。例如，同时向“Math”、“Computer Science”、“English”三列添加成绩时，字符串数组fields为{“Score:Math”,”Score:Computer Science”, ”Score:English”}，数组 values 存储这三门课的成绩。</p>
<p>​    （3）scanColumn(String tableName, String column)</p>
<p>​    浏览表tableName某一列的数据，如果某一行记录中该列数据不存在，则返回null。要求当参数column为某一列族名称时，如果底下有若干个列限定符，则要列出每个列限定符代表的列的数据；当参数column为某一列具体名称（例如“Score:Math”）时，只需要列出该列的数据。<br>​     （4）modifyData(String tableName, String row, String column)</p>
<p>​       修改表tableName，行row（可以用学生姓名S_Name表示），列column指定的单元格的数据。</p>
<p>​       （5）deleteRow(String tableName, String row)</p>
<p>​       删除表tableName中row指定的行的记录。</p>
<p>JAVA代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.conf.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.Cell;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.CellUtil;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.HBaseConfiguration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.HColumnDescriptor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.HTableDescriptor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.TableName;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.client.Admin;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.client.Connection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.client.ConnectionFactory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.client.Delete;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.client.Put;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.client.Result;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.client.ResultScanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.client.Scan;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.client.Table;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.util.Bytes;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test_Two</span> &#123;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Configuration configuration;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Connection connection;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Admin admin;</span><br><span class="line"><span class="comment">//建立连接</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">()</span>&#123;</span><br><span class="line">configuration = HBaseConfiguration.create();</span><br><span class="line">configuration.set(<span class="string">&quot;hbase.rootdir&quot;</span>,<span class="string">&quot;hdfs://localhost:9000/hbase&quot;</span>);</span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">connection = ConnectionFactory.createConnection(configuration);</span><br><span class="line">admin = connection.getAdmin();</span><br><span class="line">&#125;<span class="keyword">catch</span> (IOException e)&#123;</span><br><span class="line">e.printStackTrace();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//关闭连接</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">close</span><span class="params">()</span>&#123;</span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line"><span class="keyword">if</span>(admin != <span class="literal">null</span>)&#123;</span><br><span class="line">admin.close();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="literal">null</span> != connection)&#123;</span><br><span class="line">connection.close();</span><br><span class="line">&#125;</span><br><span class="line">&#125;<span class="keyword">catch</span> (IOException e)&#123;</span><br><span class="line">e.printStackTrace();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">*jian表。参数tableName为表的名称，字符串数组fields为存储记录各个域名称的数组。</span></span><br><span class="line"><span class="comment">* 要求当HBase已经存在名为tableName的表时，先删除原有的表，然后再</span></span><br><span class="line"><span class="comment">* 创建新的表 field：列族</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> myTableName 表名</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> colFamily 列族名</span></span><br><span class="line"><span class="comment">* <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">createTable</span><span class="params">(String tableName,String[] fields)</span></span><br><span class="line"><span class="keyword">throws</span> IOException &#123;</span><br><span class="line">init();</span><br><span class="line"><span class="type">TableName</span> <span class="variable">tablename</span> <span class="operator">=</span> TableName.valueOf(tableName);</span><br><span class="line"><span class="keyword">if</span>(admin.tableExists(tablename))&#123;</span><br><span class="line">System.out.println(<span class="string">&quot;表已存在，将执行删除原表，重建新表!&quot;</span>);</span><br><span class="line">admin.disableTable(tablename);</span><br><span class="line">admin.deleteTable(tablename);<span class="comment">//删除原来的表</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// HTableDescriptor hTableDescriptor = new HTableDescriptor(tableName);</span></span><br><span class="line"><span class="type">HTableDescriptor</span> <span class="variable">hTableDescriptor</span> <span class="operator">=</span> <span class="keyword">new</span></span><br><span class="line"><span class="title class_">HTableDescriptor</span>(TableName.valueOf(tableName));</span><br><span class="line"><span class="keyword">for</span>(String str:fields)&#123;</span><br><span class="line"><span class="type">HColumnDescriptor</span> <span class="variable">hColumnDescriptor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HColumnDescriptor</span>(str);</span><br><span class="line"></span><br><span class="line">hTableDescriptor.addFamily(hColumnDescriptor);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">admin.createTable(hTableDescriptor);</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;表已创建成功&quot;</span>);</span><br><span class="line"></span><br><span class="line">close();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">* 向表 tableName、行 row（用 S_Name 表示）和字符串数组 fields</span></span><br><span class="line"><span class="comment">指定的单元格中</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">* 添加对应的数据 values。</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">* 其中，fields 中每个元素如果对应的列族下还有相应的列限定符的话，</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">* 用&quot;columnFamily:column&quot;表示。</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">* 例如，同时向&quot;Math&quot;、&quot;Computer Science&quot;、&quot;English&quot;三列添加成绩时，</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">* 字符串数组 fields 为&#123;&quot;Score:Math&quot;, &quot;Score:Computer Science&quot;,</span></span><br><span class="line"><span class="comment">&quot;Score:English&quot;&#125;，</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">* 数组values 存储这三门课的成绩。</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">addRecord</span><span class="params">(String tableName,String rowKey,String</span></span><br><span class="line"><span class="params">[]fields,String [] values)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line"></span><br><span class="line">init();</span><br><span class="line"></span><br><span class="line"><span class="type">Table</span> <span class="variable">table</span> <span class="operator">=</span> connection.getTable(TableName.valueOf(tableName));</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; fields.length; i++) &#123;</span><br><span class="line"></span><br><span class="line"><span class="type">Put</span> <span class="variable">put</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Put</span>(rowKey.getBytes());</span><br><span class="line"></span><br><span class="line">String [] cols = fields[i].split(<span class="string">&quot;:&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(cols.length==<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">put.addColumn(cols[<span class="number">0</span>].getBytes(), <span class="string">&quot;&quot;</span>.getBytes(),</span><br><span class="line">values[i].getBytes());<span class="comment">//因为当输入的是单列族，split仅读出一个字符字符串，即cols仅有一个元素</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">put.addColumn(cols[<span class="number">0</span>].getBytes(), cols[<span class="number">1</span>].getBytes(),</span><br><span class="line">values[i].getBytes());</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">table.put(put);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">table.close();</span><br><span class="line"></span><br><span class="line">close();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">* 根据表名查找表信息</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">getData</span><span class="params">(String tableName)</span><span class="keyword">throws</span> IOException&#123;</span><br><span class="line"></span><br><span class="line">init();</span><br><span class="line"></span><br><span class="line"><span class="type">Table</span> <span class="variable">table</span> <span class="operator">=</span> connection.getTable(TableName.valueOf(tableName));</span><br><span class="line"></span><br><span class="line"><span class="type">Scan</span> <span class="variable">scan</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scan</span>();</span><br><span class="line"></span><br><span class="line"><span class="type">ResultScanner</span> <span class="variable">scanner</span> <span class="operator">=</span> table.getScanner(scan);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(Result result:scanner)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">showCell((result));</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">close();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">* 格式化输出</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> result</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">showCell</span><span class="params">(Result result)</span>&#123;</span><br><span class="line"></span><br><span class="line">Cell[] cells = result.rawCells();</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(Cell cell:cells)&#123;</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;RowName(行键):&quot;</span>+<span class="keyword">new</span></span><br><span class="line"><span class="title class_">String</span>(CellUtil.cloneRow(cell))+<span class="string">&quot; &quot;</span>);</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;Timetamp(时间戳):&quot;</span>+cell.getTimestamp()+<span class="string">&quot; &quot;</span>);</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;column Family（列簇）:&quot;</span>+<span class="keyword">new</span></span><br><span class="line"><span class="title class_">String</span>(CellUtil.cloneFamily(cell))+<span class="string">&quot; &quot;</span>);</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;column Name（列名）:&quot;</span>+<span class="keyword">new</span></span><br><span class="line"><span class="title class_">String</span>(CellUtil.cloneQualifier(cell))+<span class="string">&quot; &quot;</span>);</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;value:（值）&quot;</span>+<span class="keyword">new</span></span><br><span class="line"><span class="title class_">String</span>(CellUtil.cloneValue(cell))+<span class="string">&quot; &quot;</span>);</span><br><span class="line"></span><br><span class="line">System.out.println();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">* 浏览表 tableName 某一列的数据，如果某一行记录中该列数据不存在，则返回</span></span><br><span class="line"><span class="comment">null。</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">* 要求当参数 column</span></span><br><span class="line"><span class="comment">为某一列族名称时，如果底下有若干个列限定符，则要列出每个列限定符代表的列的数据；</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">* 当参数 column</span></span><br><span class="line"><span class="comment">为某一列具体名称（例如&quot;Score:Math&quot;）时，只需要列出该列的数据。</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> tableName</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> column</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">* <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">scanColumn</span> <span class="params">(String tableName,String column)</span> <span class="keyword">throws</span></span><br><span class="line">IOException</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">init();</span><br><span class="line"></span><br><span class="line"><span class="type">Table</span> <span class="variable">table</span> <span class="operator">=</span> connection.getTable(TableName.valueOf(tableName));</span><br><span class="line"></span><br><span class="line"><span class="type">Scan</span> <span class="variable">scan</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scan</span>();</span><br><span class="line"></span><br><span class="line">String [] cols = column.split(<span class="string">&quot;:&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(cols.length==<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">scan.addFamily(Bytes.toBytes(column));</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">scan.addColumn(Bytes.toBytes(cols[<span class="number">0</span>]),Bytes.toBytes(cols[<span class="number">1</span>]));</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">ResultScanner</span> <span class="variable">scanner</span> <span class="operator">=</span> table.getScanner(scan);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">Result</span> <span class="variable">result</span> <span class="operator">=</span> scanner.next(); result !=<span class="literal">null</span>;result =</span><br><span class="line">scanner.next()) &#123;</span><br><span class="line"></span><br><span class="line">showCell(result);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">table.close();</span><br><span class="line"></span><br><span class="line">close();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">* 修改表 tableName，行 row（可以用学生姓名 S_Name 表示），列 column</span></span><br><span class="line"><span class="comment">指定的单元格的数据。</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">* <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">modifyData</span><span class="params">(String tableName,String rowKey,String</span></span><br><span class="line"><span class="params">column,String value)</span> <span class="keyword">throws</span> IOException</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">init();</span><br><span class="line"></span><br><span class="line"><span class="type">Table</span> <span class="variable">table</span> <span class="operator">=</span> connection.getTable(TableName.valueOf(tableName));</span><br><span class="line"></span><br><span class="line"><span class="type">Put</span> <span class="variable">put</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Put</span>(rowKey.getBytes());</span><br><span class="line"></span><br><span class="line">String [] cols = column.split(<span class="string">&quot;:&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(cols.length==<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">put.addColumn(column.getBytes(),<span class="string">&quot;&quot;</span>.getBytes() ,</span><br><span class="line">value.getBytes());<span class="comment">//qualifier:列族下的列名</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">put.addColumn(cols[<span class="number">0</span>].getBytes(),cols[<span class="number">1</span>].getBytes() ,</span><br><span class="line">value.getBytes());<span class="comment">//qualifier:列族下的列名</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">table.put(put);</span><br><span class="line"></span><br><span class="line">table.close();</span><br><span class="line"></span><br><span class="line">close();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">* 删除表 tableName 中 row 指定的行的记录。</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">* <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">deleteRow</span><span class="params">(String tableName,String rowKey)</span> <span class="keyword">throws</span></span><br><span class="line">IOException</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">init();</span><br><span class="line"></span><br><span class="line"><span class="type">Table</span> <span class="variable">table</span> <span class="operator">=</span> connection.getTable(TableName.valueOf(tableName));</span><br><span class="line"></span><br><span class="line"><span class="type">Delete</span> <span class="variable">delete</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Delete</span>(rowKey.getBytes());</span><br><span class="line"></span><br><span class="line">table.delete(delete);</span><br><span class="line"></span><br><span class="line">table.close();</span><br><span class="line"></span><br><span class="line">close();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> args</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">* <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line"></span><br><span class="line"><span class="type">Test_Two</span> <span class="variable">test_Two</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Test_Two</span>();</span><br><span class="line"></span><br><span class="line"><span class="type">boolean</span> <span class="variable">flag</span> <span class="operator">=</span><span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(flag)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;------------------------------------------------提供以下功能----------------------------------------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot; 1- createTable（创建表 ,提供表名、列族名） &quot;</span>);</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot; 2- addRecord （向已知表名、行键、列簇的表添加值）&quot;</span>);</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot; 3- ScanColumn（浏览表 某一列的数据） &quot;</span>);</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot; 4- modifyData（修改某表某行，某一列，指定的单元格的数据） &quot;</span>);</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot; 5- deleteRow（删除 某表 某行的记录） &quot;</span>);</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;------------------------------------------------------------------------------------------------------------------&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="type">Scanner</span> <span class="variable">scan</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line"></span><br><span class="line">String choose1=scan.nextLine();</span><br><span class="line"></span><br><span class="line"><span class="keyword">switch</span> (choose1) &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">case</span> <span class="string">&quot;1&quot;</span>:</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;请输入要创建的表名&quot;</span>);</span><br><span class="line"></span><br><span class="line">String tableName=scan.nextLine();</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;请输入要创建的表的列族个数&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> Num=scan.nextInt();</span><br><span class="line"></span><br><span class="line">String [] fields = <span class="keyword">new</span> <span class="title class_">String</span>[Num];</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;请输入要创建的表的列族&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Scanner scanner = new Scanner(System.in); scanner.next</span></span><br><span class="line"><span class="comment">如不是全局，即会记得上一次输出。相同地址读入值时*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt; fields.length;i++)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*BufferedReader in = new BufferedReader(new</span></span><br><span class="line"><span class="comment">InputStreamReader(System.in));</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">fields[i] = in.readLine();*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*fields[i]=scan.next(); 因为之前没有输入过，所以可以读入新值*/</span></span><br><span class="line"></span><br><span class="line">scan = <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line"></span><br><span class="line">fields[i]=scan.nextLine();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;正在执行创建表的操作&quot;</span>);</span><br><span class="line"></span><br><span class="line">test_Two.createTable(tableName,fields);</span><br><span class="line"></span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">case</span> <span class="string">&quot;2&quot;</span>:</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;请输入要添加数据的表名&quot;</span>);</span><br><span class="line"></span><br><span class="line">String tableName=scan.nextLine();</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;请输入要添加数据的表的行键&quot;</span>);</span><br><span class="line"></span><br><span class="line">String rowKey=scan.nextLine();</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;请输入要添加数据的表的列的个数&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="variable">num</span> <span class="operator">=</span>scan.nextInt();</span><br><span class="line"></span><br><span class="line">String fields[]=<span class="keyword">new</span> <span class="title class_">String</span>[num];</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;请输入要添加数据的表的列信息 共&quot;</span>+num+<span class="string">&quot;条信息&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt; fields.length;i++)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">BufferedReader in3= <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span></span><br><span class="line"><span class="title class_">InputStreamReader</span>(System.in));</span><br><span class="line"></span><br><span class="line">fields[i] = in3.readLine();</span><br><span class="line"></span><br><span class="line"><span class="comment">/*fields[i]=scan.next(); 因为之前没有输入过，所以可以读入新值*/</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;请输入要添加的数据信息 共&quot;</span>+num+<span class="string">&quot;条信息&quot;</span>);</span><br><span class="line"></span><br><span class="line">String values[]=<span class="keyword">new</span> <span class="title class_">String</span>[num];</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt; values.length;i++)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="type">BufferedReader</span> <span class="variable">in2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span></span><br><span class="line"><span class="title class_">InputStreamReader</span>(System.in));</span><br><span class="line"></span><br><span class="line">values[i] = in2.readLine();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;原表信息&quot;</span>);</span><br><span class="line"></span><br><span class="line">test_Two.getData(tableName);</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;正在执行向表中添加数据的操作…\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">test_Two.addRecord(tableName, rowKey, fields, values);</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;\n添加后的表的信息…&quot;</span>);</span><br><span class="line"></span><br><span class="line">test_Two.getData(tableName);</span><br><span class="line"></span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">case</span> <span class="string">&quot;3&quot;</span>:</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;请输入要查看数据的表名&quot;</span>);</span><br><span class="line"></span><br><span class="line">String tableName=scan.nextLine();</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;请输入要查看数据的列名&quot;</span>);</span><br><span class="line"></span><br><span class="line">String column=scan.nextLine();</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;查看的信息如下：…\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">test_Two.scanColumn(tableName, column);</span><br><span class="line"></span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">case</span> <span class="string">&quot;4&quot;</span>:</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;请输入要修改数据的表名&quot;</span>);</span><br><span class="line"></span><br><span class="line">String tableName=scan.nextLine();</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;请输入要修改数据的表的行键&quot;</span>);</span><br><span class="line"></span><br><span class="line">String rowKey=scan.nextLine();</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;请输入要修改数据的列名&quot;</span>);</span><br><span class="line">String column=scan.nextLine();</span><br><span class="line">System.out.println(<span class="string">&quot;请输入要修改的数据信息 &quot;</span>);</span><br><span class="line">String value=scan.nextLine();</span><br><span class="line">System.out.println(<span class="string">&quot;原表信息如下：…\n&quot;</span>);</span><br><span class="line">test_Two.getData(tableName);</span><br><span class="line">System.out.println(<span class="string">&quot;正在执行向表中修改数据的操作…\n&quot;</span>);</span><br><span class="line">test_Two.modifyData(tableName, rowKey, column, value);</span><br><span class="line">System.out.println(<span class="string">&quot;\n修改后的信息如下：…\n&quot;</span>);</span><br><span class="line">test_Two.getData(tableName);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&quot;5&quot;</span>:</span><br><span class="line">&#123;</span><br><span class="line">System.out.println(<span class="string">&quot;请输入要删除指定行的表名&quot;</span>);</span><br><span class="line">String tableName=scan.nextLine();</span><br><span class="line">System.out.println(<span class="string">&quot;请输入要删除指定行的行键&quot;</span>);</span><br><span class="line">String rowKey=scan.nextLine();</span><br><span class="line">System.out.println(<span class="string">&quot;原表信息如下：…\n&quot;</span>);</span><br><span class="line">test_Two.getData(tableName);</span><br><span class="line">System.out.println(<span class="string">&quot;正在执行向表中删除数据的操作…\n&quot;</span>);</span><br><span class="line">test_Two.deleteRow(tableName, rowKey);</span><br><span class="line">System.out.println(<span class="string">&quot;\n删除后的信息如下：…\n&quot;</span>);</span><br><span class="line">test_Two.getData(tableName);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line">&#123;</span><br><span class="line">System.out.println(<span class="string">&quot; 你的操作有误 ！！！ &quot;</span>);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">System.out.println(<span class="string">&quot; 你要继续操作吗？ 是-true 否-false &quot;</span>);</span><br><span class="line">flag=scan.nextBoolean();</span><br><span class="line">&#125;</span><br><span class="line">System.out.println(<span class="string">&quot; 程序已退出！ &quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>（1）   createTable(String tableName, String[] fields)</p>
<p><img src="https://bradtorresblog.oss-cn-beijing.aliyuncs.com/BigDataExperiment3/clip_image039.png" alt="img"></p>
<p><img src="https://bradtorresblog.oss-cn-beijing.aliyuncs.com/BigDataExperiment3/clip_image041.png" alt="img"></p>
<p><img src="https://bradtorresblog.oss-cn-beijing.aliyuncs.com/BigDataExperiment3/clip_image042.png" alt="img"></p>
<p>（2）   addRecord(String tableName, String row, String[] fields, String[] values)</p>
<p><img src="https://bradtorresblog.oss-cn-beijing.aliyuncs.com/BigDataExperiment3/clip_image043.png" alt="img"></p>
<p><img src="https://bradtorresblog.oss-cn-beijing.aliyuncs.com/BigDataExperiment3/clip_image044.png" alt="img"></p>
<p><img src="https://bradtorresblog.oss-cn-beijing.aliyuncs.com/BigDataExperiment3/clip_image045.png" alt="img"></p>
<p><img src="https://bradtorresblog.oss-cn-beijing.aliyuncs.com/BigDataExperiment3/clip_image047.png" alt="img"></p>
<p>（3）   scanColumn(String tableName, String column)</p>
<p><img src="https://bradtorresblog.oss-cn-beijing.aliyuncs.com/BigDataExperiment3/clip_image049.png" alt="img"></p>
<p>（4）   modifyData(String tableName, String row, String column)</p>
<p><img src="https://bradtorresblog.oss-cn-beijing.aliyuncs.com/BigDataExperiment3/clip_image051.png" alt="img"></p>
<p><img src="https://bradtorresblog.oss-cn-beijing.aliyuncs.com/BigDataExperiment3/clip_image053.png" alt="img"></p>
<p>（5）deleteRow(String tableName, String row)</p>
<p><img src="https://bradtorresblog.oss-cn-beijing.aliyuncs.com/BigDataExperiment3/clip_image055.png" alt="img"></p>
<p><img src="https://bradtorresblog.oss-cn-beijing.aliyuncs.com/BigDataExperiment3/clip_image057.png" alt="img"></p>
<h1 id="4-实验总结"><a href="#4-实验总结" class="headerlink" title="4.实验总结"></a>4.实验总结</h1><p><strong>（<strong><strong>1</strong></strong>）实验完成情况</strong></p>
<p>实验完成率：100%</p>
<p><strong>（<strong><strong>2</strong></strong>）出现的问题与解决方案</strong></p>
<p>问题1： 对于HBase数据库操作不熟悉</p>
<p>解决：查阅<a target="_blank" rel="noopener" href="http://dblab.xmu.edu.cn/blog/2442-2/">http://dblab.xmu.edu.cn/blog/2442-2/</a> 发现HBase操作与SQL语言相比还是有较大的不同，但是命令都比较简单易懂，容易学习</p>
<p><img src="https://bradtorresblog.oss-cn-beijing.aliyuncs.com/BigDataExperiment3/clip_image059.jpg" alt="img"></p>
<p>问题2：在运行示例程序时一直出现如下图所示的错误，无法正确创建表和插入数据</p>
<p><img src="https://bradtorresblog.oss-cn-beijing.aliyuncs.com/BigDataExperiment3/clip_image061.jpg" alt="img"></p>
<p>解决： 重启hbase后得以正常运行</p>
<p>问题2：java清空数据表代码报错：</p>
<p>Table should have at least one column family. Set</p>
<p>hbase.table.sanity.checks to false at conf or table descriptor if you</p>
<p>want to bypass sanity checks</p>
<p>解决方法： 创建Hbase数据表时至少要有一个列族名，而清空数据表的java代码其实是删除了整个数据表再重新建一个有着原表列族名的空表，因此清空的前提是要清空的数据表中含有包括一个列的数据，此时只要先在原数据空中加入一个数据再执行清空数据库的代码即可。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://hsuwindow.vip">hsuwindow</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://hsuwindow.vip/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%E5%AE%9E%E9%AA%8C3%E7%86%9F%E6%82%89%E5%B8%B8%E7%94%A8%E7%9A%84HBase%E6%93%8D%E4%BD%9C/">http://hsuwindow.vip/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%E5%AE%9E%E9%AA%8C3%E7%86%9F%E6%82%89%E5%B8%B8%E7%94%A8%E7%9A%84HBase%E6%93%8D%E4%BD%9C/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="http://hsuwindow.vip" target="_blank">hsuwindowBlogs</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a><a class="post-meta__tags" href="/tags/%E5%AD%A6%E4%B9%A0/">学习</a></div><div class="post-share"><div class="social-share" data-image="/img/ubuntu_icon.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%E5%AE%9E%E9%AA%8C4NoSQL%E5%92%8C%E5%85%B3%E7%B3%BB%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E6%93%8D%E4%BD%9C%E6%AF%94%E8%BE%83/" title="大数据技术原理与应用实验4NoSQL和关系数据库的操作比较"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">大数据技术原理与应用实验4NoSQL和关系数据库的操作比较</div></div><div class="info-2"><div class="info-item-1">实验4 NoSQL和关系数据库的操作比较1.  实验目的（1）理解四种数据库(MySQL、 HBase、 Redis 和 MongoDB)的概念以及不同点； （2）熟练使用四种数据库操作常用的 Shell 命令； （3）熟悉四种数据库操作常用的 Java API。 2.实验平台（1） 操作系统： Linux（Ubuntu-22.04.2）； （2） Hadoop 版本： 3.1.3； （3） MySQL 版本： 8.0.32； （4） HBase 版本： 2.2.2； （5） Redis 版本： 7.0.10； （6） MongoDB 版本： 6.0.5； （7） JDK 版本： 1.8； （8） Java IDE： Eclipse； 3.实验步骤与结果（一） MySQL 数据库操作 学生表如 14-7 所示。 表 14-7 学生表 Student    Name English Math Computer    zhangsan 69 86 77   lisi 55 100 88   \1. 根据上面给出的 Student 表，在 MySQL 数据库中完成如下操作： （1）在...</div></div></div></a><a class="pagination-related" href="/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%E5%AE%9E%E9%AA%8C2%E7%86%9F%E6%82%89%E5%B8%B8%E7%94%A8%E7%9A%84HDFS%E6%93%8D%E4%BD%9C/" title="大数据技术原理与应用实验2熟悉常用的HDFS操作"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">大数据技术原理与应用实验2熟悉常用的HDFS操作</div></div><div class="info-2"><div class="info-item-1">实验2 熟悉常用的 HDFS 操作1.实验目的（1） 理解 HDFS 在 Hadoop 体系结构中的角色； （2） 熟练使用 HDFS 操作常用的 Shell 命令； （3） 熟悉 HDFS 操作常用的 Java API。  2.实验平台（1） 操作系统： Linux（Ubuntu-22.04.2-desktop-amd64）； （2） Hadoop 版本： 3.1.3； （3） JDK 版本： 1.8； （4） Java IDE： Eclipse。  3.实验步骤与结果（一）编程实现以下功能，并利用 Hadoop 提供的 Shell 命令完成相同任务： （1） 向 HDFS 中上传任意文本文件，如果指定的文件在 HDFS...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%E5%8D%8E%E4%B8%BA%E4%BA%91%E5%AE%9E%E9%AA%8C%E5%AE%9E%E6%97%B6%E5%88%86%E6%9E%90/" title="大数据技术原理与应用华为云实验实时分析"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2023-04-30</div><div class="info-item-2">大数据技术原理与应用华为云实验实时分析</div></div><div class="info-2"><div class="info-item-1">1.实验目的l 掌握大数据相关服务的购买及基础配置 l 掌握使用Flume采集数据 l 掌握Flink SQL代码的编写 l 掌握使用DLV进行数据可视化 l 掌握实时流数据的处理流程 2.实验平台与服务l MRS (MapReduce Service) MapReduce服务是一个在华为云上部署和管理Hadoop系统的服务，一键即可部署Hadoop集群。 l DLI (Data Lake Insight) 数据湖探索是完全兼容Apache Spark、Apache Flink、openLooKeng（基于Apache Presto）生态，提供一站式的流处理、批处理、交互式分析的Serverless融合处理分析服务。 l RDS (Relational Database Service) 华为云关系型数据库是一种基于云计算平台的即开即用、稳定可靠、弹性伸缩、便捷管理的在线关系型数据库服务，支持单机和主备部署模式，支持MySQL、PostgreSQL、SQL Server等主流的关系型数据库引擎。 l CDM (Cloud Data...</div></div></div></a><a class="pagination-related" href="/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%E5%AE%9E%E9%AA%8C1%E7%86%9F%E6%82%89%E5%B8%B8%E7%94%A8%E7%9A%84Linux%E6%93%8D%E4%BD%9C%E5%92%8CHadoop%E6%93%8D%E4%BD%9C/" title="大数据技术原理与应用实验1熟悉常用的Linux操作和Hadoop操作"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2023-04-05</div><div class="info-item-2">大数据技术原理与应用实验1熟悉常用的Linux操作和Hadoop操作</div></div><div class="info-2"><div class="info-item-1">实验1 熟悉常用的Linux操作和Hadoop操作1.实验目的Hadoop运行在Linux系统上，因此，需要学习实践一些常用的Linux命令。本实验旨在熟悉常用的Linux操作和Hadoop操作，为顺利开展后续其他实验奠定基础。 2.实验平台（1）操作系统： Ubuntu-22.04.2-desktop-amd64 （2）Hadoop版本：3.1.3 3.实验步骤与结果*1.熟悉常用的Linux*操作 1）cd命令：切换目录 （1）   切换到目录“&#x2F;usr&#x2F;local”  （2）   切换到当前目录的上一级目录  （3）  ...</div></div></div></a><a class="pagination-related" href="/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%E5%8D%8E%E4%B8%BA%E4%BA%91%E5%AE%9E%E9%AA%8C%E5%AE%9E%E6%97%B6%E6%A3%80%E7%B4%A2/" title="大数据技术原理与应用华为云实验实时检索"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2023-04-25</div><div class="info-item-2">大数据技术原理与应用华为云实验实时检索</div></div><div class="info-2"><div class="info-item-1">1.实验介绍1.1.实验概述本实验基于华为云服务。通过模拟开发流程，包括数据导入库，组件应用开发，构建搜索服务，最终完成实时检索功能。 1.2.实验目的l 掌握大数据相关服务的购买及基础配置 l 掌握HBase应用开发的基本语法 l 掌握ElasticSearch应用开发的基本语法 l 掌握实时检索的功能实现 1.3.实验规划在同一VPC内的ECS通过内网访问MRS HBase和CSS各自的网络地址，并通过各自网络地址完成数据导入和数据查询。  1.4.实验思路（1）通过配置和申请华为云服务VPC，ECS，MRS和CSS作为基础配置。 （2）ECS在同一VPC内通过安全组规则访问MRS和CSS服务。 （3）在ECS上搭建基本应用开发环境。 （4）在ECS上建工程项目，开发基于MRS和CSS的应用程序。 （5）服务使用完毕，进行释放资源。 1.5.实验流程 2.实验平台与服务l ECS (Elastic Cloud...</div></div></div></a><a class="pagination-related" href="/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%E5%AE%9E%E9%AA%8C2%E7%86%9F%E6%82%89%E5%B8%B8%E7%94%A8%E7%9A%84HDFS%E6%93%8D%E4%BD%9C/" title="大数据技术原理与应用实验2熟悉常用的HDFS操作"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2023-04-05</div><div class="info-item-2">大数据技术原理与应用实验2熟悉常用的HDFS操作</div></div><div class="info-2"><div class="info-item-1">实验2 熟悉常用的 HDFS 操作1.实验目的（1） 理解 HDFS 在 Hadoop 体系结构中的角色； （2） 熟练使用 HDFS 操作常用的 Shell 命令； （3） 熟悉 HDFS 操作常用的 Java API。  2.实验平台（1） 操作系统： Linux（Ubuntu-22.04.2-desktop-amd64）； （2） Hadoop 版本： 3.1.3； （3） JDK 版本： 1.8； （4） Java IDE： Eclipse。  3.实验步骤与结果（一）编程实现以下功能，并利用 Hadoop 提供的 Shell 命令完成相同任务： （1） 向 HDFS 中上传任意文本文件，如果指定的文件在 HDFS...</div></div></div></a><a class="pagination-related" href="/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%E5%AE%9E%E9%AA%8C4NoSQL%E5%92%8C%E5%85%B3%E7%B3%BB%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E6%93%8D%E4%BD%9C%E6%AF%94%E8%BE%83/" title="大数据技术原理与应用实验4NoSQL和关系数据库的操作比较"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2023-04-05</div><div class="info-item-2">大数据技术原理与应用实验4NoSQL和关系数据库的操作比较</div></div><div class="info-2"><div class="info-item-1">实验4 NoSQL和关系数据库的操作比较1.  实验目的（1）理解四种数据库(MySQL、 HBase、 Redis 和 MongoDB)的概念以及不同点； （2）熟练使用四种数据库操作常用的 Shell 命令； （3）熟悉四种数据库操作常用的 Java API。 2.实验平台（1） 操作系统： Linux（Ubuntu-22.04.2）； （2） Hadoop 版本： 3.1.3； （3） MySQL 版本： 8.0.32； （4） HBase 版本： 2.2.2； （5） Redis 版本： 7.0.10； （6） MongoDB 版本： 6.0.5； （7） JDK 版本： 1.8； （8） Java IDE： Eclipse； 3.实验步骤与结果（一） MySQL 数据库操作 学生表如 14-7 所示。 表 14-7 学生表 Student    Name English Math Computer    zhangsan 69 86 77   lisi 55 100 88   \1. 根据上面给出的 Student 表，在 MySQL 数据库中完成如下操作： （1）在...</div></div></div></a><a class="pagination-related" href="/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%E5%AE%9E%E9%AA%8C5MapReduce%E5%88%9D%E7%BA%A7%E7%BC%96%E7%A8%8B%E5%AE%9E%E8%B7%B5/" title="大数据技术原理与应用实验5MapReduce初级编程实践"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2023-04-20</div><div class="info-item-2">大数据技术原理与应用实验5MapReduce初级编程实践</div></div><div class="info-2"><div class="info-item-1">实验5 MapReduce初级编程实践1.  实验目的（1） 通过实验掌握基本的 MapReduce 编程方法； （2） 掌握用 MapReduce 解决一些常见的数据处理问题，包括数据去重、数据排序和数据挖掘等。 2.实验平台（1） 操作系统： Linux（Ubuntu22.04）； （2） Hadoop 版本： 3.1.3；  3.实验步骤与结果（一）编程实现文件合并和去重操作 对于两个输入文件，即文件 A 和文件 B，请编写 MapReduce 程序，对两个文件进行合并，并剔除其中重复的内容，得到一个新的输出文件 C。下面是输入文件和输出文件的一个样例供参考。 输入文件 A 的样例如下： 123456789101120170101 x   20170102 y  20170103 x 20170104 y 20170105 z 20170106 x    输入文件 B 的样例如下： 12345678920170101 y 20170102 y 20170103 x 20170104 z 20170105 y    根据输入文件 A 和 B 合并得到的输出文件 C...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/ubuntu_icon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">hsuwindow</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">78</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">25</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">20</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">欢迎光临本站,这是我日常工作和学习整理的总结,希望对你有所帮助.本站内容经过个人加工总结而来,也参考了网友们分享的资料,如有侵权,请第一时间联系我,我将及时进行修改或删除.</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C3-%E7%86%9F%E6%82%89%E5%B8%B8%E7%94%A8%E7%9A%84HBase%E6%93%8D%E4%BD%9C"><span class="toc-text">实验3 熟悉常用的HBase操作</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#1-%E5%AE%9E%E9%AA%8C%E7%9B%AE%E7%9A%84"><span class="toc-text">1.  实验目的</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-%E5%AE%9E%E9%AA%8C%E5%B9%B3%E5%8F%B0"><span class="toc-text">2.实验平台</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3-%E5%AE%9E%E9%AA%8C%E6%AD%A5%E9%AA%A4%E4%B8%8E%E7%BB%93%E6%9E%9C"><span class="toc-text">3.实验步骤与结果</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#4-%E5%AE%9E%E9%AA%8C%E6%80%BB%E7%BB%93"><span class="toc-text">4.实验总结</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/cshsuwindowDIY/%E7%AE%97%E6%B3%95%E5%92%8C%E6%95%B0%E5%AD%A6/%E4%BB%A3%E7%A0%81%E9%9A%8F%E6%83%B3%E5%BD%95/AAA%E6%A8%A1%E6%9D%BF%E4%BB%A3%E7%A0%81%E9%9A%8F%E6%83%B3%E5%BD%95%E7%AE%97%E6%B3%95%E8%AE%AD%E7%BB%83%E8%90%A554%E6%9C%9FdayXX/" title="模板代码随想录算法训练营54期dayXX">模板代码随想录算法训练营54期dayXX</a><time datetime="2025-01-08T07:30:17.709Z" title="发表于 2025-01-08 15:30:17">2025-01-08</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/cshsuwindowDIY/%E7%AE%97%E6%B3%95%E5%92%8C%E6%95%B0%E5%AD%A6/%E9%A2%98%E8%A7%A3/%E4%B8%80%E6%9C%AC%E9%80%9A/%E4%BF%A1%E6%81%AF%E5%AD%A6%E5%A5%A5%E8%B5%9B%E4%B8%80%E6%9C%AC%E9%80%9A%E9%A2%98%E8%A7%A3%E5%9F%BA%E7%A1%80%E4%BA%8C(%E9%9D%9E%E5%AE%98%E6%96%B9)/" title="信息学奥赛一本通题解基础二(非官方)">信息学奥赛一本通题解基础二(非官方)</a><time datetime="2024-11-09T05:14:42.746Z" title="发表于 2024-11-09 13:14:42">2024-11-09</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/%E6%9C%AA%E5%88%86%E7%B1%BB/typora%E8%AE%BE%E7%BD%AE%E4%BB%A3%E7%A0%81%E5%9D%97%E9%BB%98%E8%AE%A4%E8%AF%AD%E8%A8%80/" title="typora设置代码块默认语言">typora设置代码块默认语言</a><time datetime="2024-11-03T09:21:45.317Z" title="发表于 2024-11-03 17:21:45">2024-11-03</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/cshsuwindowDIY/%E7%AE%97%E6%B3%95%E5%92%8C%E6%95%B0%E5%AD%A6/%E9%A2%98%E8%A7%A3/%E4%B8%80%E6%9C%AC%E9%80%9A/%E4%BF%A1%E6%81%AF%E5%AD%A6%E5%A5%A5%E8%B5%9B%E4%B8%80%E6%9C%AC%E9%80%9A%E9%A2%98%E8%A7%A3%E5%9F%BA%E7%A1%80%E4%B8%80(%E9%9D%9E%E5%AE%98%E6%96%B9)/" title="信息学奥赛一本通题解基础一(非官方)">信息学奥赛一本通题解基础一(非官方)</a><time datetime="2024-11-03T09:04:58.947Z" title="发表于 2024-11-03 17:04:58">2024-11-03</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/cshsuwindowDIY/C/grammar/C++PrimerPlusStudyNotesCh8/" title="C++PrimerPlusStudyNotesCh8">C++PrimerPlusStudyNotesCh8</a><time datetime="2024-10-30T06:41:20.958Z" title="发表于 2024-10-30 14:41:20">2024-10-30</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2025 By hsuwindow</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">简</button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><div class="js-pjax"></div><canvas class="fireworks" mobile="true"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/fireworks.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>